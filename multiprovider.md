# Задача для Codex

Расширить функциональность выбора API-провайдера и моделей.

## 1️⃣ Изменение логики выбора API

Сейчас:
- пользователь вручную вводит `base_url`
- пользователь вручную вводит `api_key`

Нужно:
- добавить выпадающий список провайдеров
- сохранить возможность кастомного ввода (Custom Provider)

## 2️⃣ Источник данных провайдеров

В приложении должен появиться преднастроенный список провайдеров:

| Провайдер | Base URL |
| --- | --- |
| OpenAI | https://api.openai.com/v1/ |
| Anthropic Claude | https://api.anthropic.com/v1/ |
| Together AI | https://api.together.ai/v1/ |
| Mistral AI | https://api.mistral.ai/v1/ |
| Perplexity | https://api.perplexity.ai/ |
| Yandex AI Studio | https://api.ai.yandex.net/v1/ |
| Replicate | https://api.replicate.com/v1/ |
| DeepSeek | https://api.deepseek.com/ |
| Groq | https://api.groq.com/openai/v1/ |
| Alibaba DashScope | https://dashscope.aliyuncs.com/api/v1/ |
| Custom / Self-hosted | пользователь вводит вручную |

## 3️⃣ Авторизация

У разных провайдеров разный формат заголовка. Нужно поддержать хранение схем авторизации у провайдера:

| Провайдер | Header | Формат |
| --- | --- | --- |
| OpenAI | Authorization | Bearer `<KEY>` |
| Anthropic | x-api-key | `<KEY>` |
| Yandex | Authorization | Api-Key `<KEY>` |
| Replicate | Authorization | Token `<KEY>` |
| Остальные | Authorization | Bearer `<KEY>` |

Нужно:
- при выборе провайдера автоматически применять правильный формат
- пользователю вводить только ключ
- UI подсказка: какой формат используется

## 4️⃣ Динамическая загрузка списка моделей

После выбора API приложение делает запрос к:

```http
GET {base_url}/models
```

Исключения:
- Anthropic — нужно использовать их messages API вместо прямого списка
- Replicate — отдельный список моделей
- Perplexity — фиксированный набор (можно зашить fallback)

Если список получить нельзя → показать сообщение и оставить ручной ввод модели.  
Результат отобразить в выпадающем списке.

## 5️⃣ Поведение UI

- Пользователь выбирает провайдера
- Вводит ключ
- Приложение:
  - автоматически подставляет `base_url`
  - настраивает auth header
  - подгружает список моделей
- Пользователь выбирает модель из списка
- Всё сохраняется в настройки

## 6️⃣ Требования к UX

- сохранение выбранного провайдера между сессиями
- возможность сменить провайдера без перезапуска
- graceful fallback:
  - если models API недоступно
  - если ключ неверный
- дружелюбные сообщения об ошибках

## 7️⃣ Acceptance Criteria

- ✔ В настройках есть выпадающий список провайдеров
- ✔ Можно выбрать custom provider и вручную ввести адрес
- ✔ API Key поддерживает разные форматы авторизации
- ✔ Список моделей загружается по API автоматически
- ✔ Если список недоступен — можно ввести модель вручную
- ✔ Работает со всеми указанными провайдерами
- ✔ Ничего не ломает текущий функционал
